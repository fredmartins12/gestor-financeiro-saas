<!DOCTYPE html>
<html lang="pt-BR" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel de Gestão Financeira</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <style>
        body { font-family: 'Inter', sans-serif; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; }
        /* Custom scrollbar for dark theme */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #1e293b; }
        ::-webkit-scrollbar-thumb { background: #475569; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #64748b; }
        .modal-content { max-height: 90vh; overflow-y: auto; }

        .tab-btn { padding: 0.5rem 1rem; border-bottom: 2px solid transparent; font-weight: 600; cursor: pointer; transition: all 0.2s; color: #94a3b8; }
        .tab-btn:hover { color: #cbd5e1; }
        .tab-btn.active { color: #818cf8; border-bottom-color: #6366f1; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        
        .action-btn { cursor: pointer; font-weight: 500; transition: color 0.2s; }
        .edit-btn { color: #818cf8; } .edit-btn:hover { color: #a5b4fc; }
        .delete-btn { color: #f87171; } .delete-btn:hover { color: #fca5a5; }

        .status-tag { padding: 0.25rem 0.75rem; border-radius: 9999px; font-size: 0.75rem; font-weight: 600; display: inline-flex; align-items: center; gap: 0.25rem; }
        .tag-deposit { background-color: #fef9c3; color: #ca8a04; border: 1px solid #fde047; }
        .tag-paid { color: #16a34a; }
        .tag-due { color: #f59e0b; }
        .tag-overdue { color: #ef4444; }
        .pay-btn { cursor: pointer; color: #818cf8; font-weight: 500; margin-left: 8px; }
        .pay-btn:hover { text-decoration: underline; }
    </style>
</head>
<body class="bg-slate-900 text-slate-300">

    <div id="toast-container"></div>

    <div id="account-modal" class="modal-overlay">
        <div class="modal-content w-full max-w-lg bg-slate-800 border border-slate-700 rounded-lg p-6">
            <h3 id="modal-title" class="text-xl font-bold mb-6 text-white">Cadastrar Nova Conta</h3>
            <form id="account-form" class="space-y-4 text-left">
                <input type="hidden" id="account-id" name="account-id">
                <div><label for="account-name" class="block text-sm font-medium text-slate-400">Nome</label><input type="text" id="account-name" name="account-name" class="mt-1 block w-full bg-slate-700 border-slate-600 text-white rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500" required></div>
                <div>
                    <label for="account-provider" class="block text-sm font-medium text-slate-400">Casa de Aposta</label>
                    <select id="account-provider" name="account-provider" class="mt-1 block w-full bg-slate-700 border-slate-600 text-white rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500" required>
                        <option value="">Selecione...</option>
                        <option value="bet365">Bet365</option>
                        <option value="betesporte">BetEsporte</option>
                        <option value="betano">Betano</option>
                        <option value="sportingbet">Sportingbet</option>
                        <option value="pessoal">Pessoal (Conta não relacionada a apostas)</option>
                    </select>
                </div>
                <div><label for="account-balance" class="block text-sm font-medium text-slate-400">Saldo (R$)</label><input type="number" id="account-balance" name="account-balance" step="0.01" class="mt-1 block w-full bg-slate-700 border-slate-600 text-white rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"></div>
                <div><label for="account-freebet-balance" class="block text-sm font-medium text-slate-400">Saldo de Freebets (R$)</label><input type="number" id="account-freebet-balance" name="account-freebet-balance" step="0.01" class="mt-1 block w-full bg-slate-700 border-slate-600 text-white rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"></div>
                <div class="grid grid-cols-2 gap-4">
                    <div><label for="account-payment-day" class="block text-sm font-medium text-slate-400">Dia do Pgto. (1-31)</label><input type="number" id="account-payment-day" name="account-payment-day" min="1" max="31" class="mt-1 block w-full bg-slate-700 border-slate-600 text-white rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"></div>
                    <div><label for="account-payment-value" class="block text-sm font-medium text-slate-400">Valor do Pgto. (R$)</label><input type="number" id="account-payment-value" name="account-payment-value" step="0.01" class="mt-1 block w-full bg-slate-700 border-slate-600 text-white rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"></div>
                </div>
                <div><label for="account-goal" class="block text-sm font-medium text-slate-400">Meta do Clube (R$)</label><input type="number" id="account-goal" name="account-goal" step="0.01" class="mt-1 block w-full bg-slate-700 border-slate-600 text-white rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500" value="100"></div>
                <div><label for="account-club-volume" class="block text-sm font-medium text-slate-400">Volume Válido (Inicial)</label><input type="number" id="account-club-volume" name="account-club-volume" step="0.01" class="mt-1 block w-full bg-slate-700 border-slate-600 text-white rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"></div>
                <div><label for="account-last-code-date" class="block text-sm font-medium text-slate-400">Data do Último Código</label><input type="date" id="account-last-code-date" name="account-last-code-date" class="mt-1 block w-full bg-slate-700 border-slate-600 text-white rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"></div>
                <div><label for="account-obs" class="block text-sm font-medium text-slate-400">Observações</label><textarea id="account-obs" name="account-obs" rows="3" class="mt-1 block w-full bg-slate-700 border-slate-600 text-white rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"></textarea></div>
                <div class="pt-4 flex justify-end gap-4"><button type="button" class="cancel-modal-btn bg-slate-600 text-white py-2 px-4 rounded-md hover:bg-slate-500 font-semibold transition-colors">Cancelar</button><button type="submit" class="bg-indigo-600 text-white py-2 px-4 rounded-md w-24 flex justify-center hover:bg-indigo-500 font-semibold transition-colors">Salvar</button></div>
            </form>
        </div>
    </div>
    <div id="transaction-modal" class="modal-overlay">...</div>
    <div id="transfer-modal" class="modal-overlay">...</div>
    <div id="report-modal" class="modal-overlay">...</div>
    <div id="expense-modal" class="modal-overlay">...</div>
    
    <div class="max-w-screen-xl mx-auto p-4 sm:p-6 lg:p-8">
        <header class="mb-10 flex justify-between items-center">
            <div>
                <h1 class="text-3xl font-bold text-white">Painel de Gestão</h1>
                <p class="text-slate-400 mt-1">Bem-vindo(a)! Monitore suas finanças e operações.</p>
            </div>
            <a href="/logout" class="bg-slate-700 text-slate-300 py-2 px-4 rounded-lg hover:bg-slate-600 hover:text-white font-semibold transition-colors flex items-center gap-2">
                Sair
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path fill-rule="evenodd" d="M3 4.25A2.25 2.25 0 015.25 2h5.5A2.25 2.25 0 0113 4.25v2a.75.75 0 01-1.5 0v-2a.75.75 0 00-.75-.75h-5.5a.75.75 0 00-.75.75v11.5c0 .414.336.75.75.75h5.5a.75.75 0 00.75-.75v-2a.75.75 0 011.5 0v2A2.25 2.25 0 0110.75 18h-5.5A2.25 2.25 0 013 15.75V4.25z" clip-rule="evenodd" /><path fill-rule="evenodd" d="M19 10a.75.75 0 00-.75-.75H8.75a.75.75 0 000 1.5h9.5a.75.75 0 00.75-.75z" clip-rule="evenodd" /><path fill-rule="evenodd" d="M15.53 6.47a.75.75 0 00-1.06 0l-3 3a.75.75 0 000 1.06l3 3a.75.75 0 101.06-1.06L13.06 10l2.47-2.47a.75.75 0 000-1.06z" clip-rule="evenodd" /></svg>
            </a>
        </header>

        <div class="mb-12">
            <div class="flex justify-between items-center mb-6 flex-wrap gap-4">
                <h2 class="text-2xl font-bold text-white">Painel de Contas</h2>
                <div class="flex gap-2 sm:gap-3 flex-wrap">
                    <button id="add-account-btn" class="bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-500 font-semibold transition-colors flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z" /></svg>Nova Conta</button>
                    <button id="add-transaction-btn" class="bg-slate-700 text-slate-200 py-2 px-4 rounded-lg hover:bg-slate-600 font-semibold transition-colors">Lançamento</button>
                    <button id="transfer-btn" class="bg-slate-700 text-slate-200 py-2 px-4 rounded-lg hover:bg-slate-600 font-semibold transition-colors">Transferência</button>
                    <button id="add-expense-btn" class="bg-slate-700 text-slate-200 py-2 px-4 rounded-lg hover:bg-slate-600 font-semibold transition-colors">Gasto</button>
                    <button id="report-btn" class="bg-slate-700 text-slate-200 py-2 px-4 rounded-lg hover:bg-slate-600 font-semibold transition-colors">Relatórios</button>
                </div>
            </div>

            <div class="mb-6 flex items-center gap-2 flex-wrap border-b border-slate-700" id="main-tabs-container">
                <button class="tab-btn active" data-tab="bet365">Bet365</button>
                <button class="tab-btn" data-tab="betesporte">BetEsporte</button>
                <button class="tab-btn" data-tab="betano">Betano</button>
                <button class="tab-btn" data-tab="sportingbet">Sportingbet</button>
                <button class="tab-btn" data-tab="personal">Contas Pessoais</button>
            </div>

            <div class="bg-slate-800 rounded-lg overflow-hidden">
                <div class="overflow-x-auto">
                    <div id="tab-content-bet365" class="tab-content active">
                        <table class="w-full text-sm text-left text-slate-400">
                            <thead class="text-xs text-slate-400 uppercase bg-slate-700/50">
                                <tr class="betting-accounts-header">
                                    <th class="px-6 py-4">Status</th>
                                    <th class="px-6 py-4">Nome</th>
                                    <th class="px-6 py-4">Saldo (R$)</th>
                                    <th class="px-6 py-4">Freebets (R$)</th>
                                    <th class="px-6 py-4">Próximo Pgto.</th>
                                    <th class="px-6 py-4">Ações</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-slate-700" id="bet365-accounts-body"></tbody>
                        </table>
                    </div>
                    <div id="tab-content-betesporte" class="tab-content">...</div>
                    <div id="tab-content-betano" class="tab-content">...</div>
                    <div id="tab-content-sportingbet" class="tab-content">...</div>
                    <div id="tab-content-personal" class="tab-content">...</div>
                </div>
            </div>
        </div>

        <div class="mb-12">
            <h2 class="text-2xl font-bold text-white mb-6">Resumo Financeiro</h2>
            <div id="financial-summary-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                </div>
        </div>

        <div class="mb-12">
            <h2 class="text-2xl font-bold text-white mb-6">Operações Ativas</h2>
            <div id="active-operations-container" class="space-y-4"></div>
        </div>

        <div class="mb-12">
            <h2 class="text-2xl font-bold text-white mb-6">Registrar Operação de Aposta</h2>
            <div class="bg-slate-800 border border-slate-700 rounded-lg p-6">
                <form id="operation-form">
                    </form>
            </div>
        </div>
        
        <div class="mb-12">
            <h2 class="text-2xl font-bold text-white mb-6">Histórico de Transações Recentes</h2>
            <div class="bg-slate-800 rounded-lg overflow-hidden border border-slate-700">
                <div class="overflow-x-auto">
                    <table class="w-full text-sm text-left text-slate-400">
                        <thead class="text-xs text-slate-400 uppercase bg-slate-700/50">
                            <tr>
                                <th class="px-6 py-4">Data</th>
                                <th class="px-6 py-4">Conta</th>
                                <th class="px-6 py-4">Descrição</th>
                                <th class="px-6 py-4">Tipo</th>
                                <th class="px-6 py-4 text-right">Valor (R$)</th>
                                <th class="px-6 py-4 text-center">Ação</th>
                            </tr>
                        </thead>
                        <tbody id="transactions-history-body" class="divide-y divide-slate-700"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <div>
            <h2 class="text-2xl font-bold text-white mb-6">Ferramentas de Dados</h2>
            <div class="bg-slate-800 border border-slate-700 rounded-lg p-8">
                 <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                     <div class="md:border-r border-slate-700 md:pr-8">
                         <h3 class="text-lg font-semibold text-white mb-2">Fazer Backup</h3>
                         <p class="text-sm text-slate-400 mb-4">Baixe um arquivo (.json) com todos os seus dados.</p>
                         <button id="backup-btn" class="bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-500 font-semibold flex items-center justify-center w-40 transition-colors">Baixar Backup</button>
                     </div>
                     <div class="md:border-r border-slate-700 md:pr-8">
                         <h3 class="text-lg font-semibold text-white mb-2">Restaurar Backup</h3>
                         <p class="text-sm text-slate-400 mb-4"><strong class="text-red-400">Atenção:</strong> Irá apagar todos os dados atuais.</p>
                         <input type="file" id="restore-file-input" accept=".json" class="block w-full text-sm text-slate-400 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-violet-900/50 file:text-violet-300 hover:file:bg-violet-800/50 cursor-pointer"/>
                         <button id="restore-btn" class="mt-4 bg-red-600 text-white py-2 px-4 rounded-lg hover:bg-red-500 font-semibold disabled:bg-slate-600 disabled:cursor-not-allowed w-40 flex justify-center transition-colors" disabled>Restaurar Dados</button>
                     </div>
                     <div>
                         <h3 class="text-lg font-semibold text-white mb-2">Importar Contas via CSV</h3>
                         <p class="text-sm text-slate-400 mb-4">Crie ou atualize múltiplas contas. <button id="download-template-btn" class="text-indigo-400 hover:underline">Baixe o modelo</button>.</p>
                         <input type="file" id="csv-file-input" accept=".csv" class="block w-full text-sm text-slate-400 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-teal-900/50 file:text-teal-300 hover:file:bg-teal-800/50 cursor-pointer"/>
                         <button id="import-csv-btn" class="mt-4 bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-500 font-semibold disabled:bg-slate-600 disabled:cursor-not-allowed w-40 flex justify-center transition-colors" disabled>Importar CSV</button>
                     </div>
                 </div>
            </div>
        </div>
    </div>

    <script src="/static/main.js"></script>
</body>
</html>